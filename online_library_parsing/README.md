# Описание

Скрипт написан в образовательных целях, согласно Уроку №3 "Парсим онлайн-библиотеку" модуля "Вёрстка для питониста", в целях помощи двенадцатилетнему Максиму и спасения его дедушки от скуки и единообразия деревенской жизни при отуствии доступа в Интернет. Спасибо [Devman](https://dvmn.org/).

Скрипт качает книги, их обложки и описание для использования off-line с сайта [БОЛЬШАЯ БЕСПЛАТНАЯ БИБЛИОТЕКА](http://tululu.org/)  

## Подготовка к использованию

Для запуска скриптов на Python, очевидно, что у вас уже должен быть установлен Python. Используем версию 3, потому как версия 2 уже со всеми попрощалась...

Итак
- Качаем код. На самом деле нам достаточно только [main.py](https://github.com/Sam1808/site-layout/blob/master/online_library_parsing/main.py) - это тело скрипта и [requirements.txt](https://github.com/Sam1808/site-layout/blob/master/online_library_parsing/requirements.txt) - для установки зависимостей.
- Поднимаем виртуальное окружение (необязательно, но крайне полезно), командой `python3 -m venv my_virtual_env` и запускаем его командой, в зависимости от используемой операционной системы.
- Устанавливаем зависимости `pip install -r requirements.txt`
- Задерживаем дыхаение, чтобы насладиться процессом.

## Запуск ...и получаемые результаты

Максим рассказывал, утирая слезы, что дедушка его - ярый фанат научной фантастики. Сказано - сделано! Можно просто запустить скрипт и он уже будет работать, вот так:

`python main.py`

Что произойдет... скрипт постучится на сайт библиотеки, именно в раздел [научной фантастики](http://tululu.org/l55/) и начнет методично скачивать все книги в `books`, картинки к скаченным книжкам в `images`, а описание сложит в `books_description.json`.

<details>
<summary>О файле books_description.json</summary>

  Как и сказано, в файл `books_description.json` складывается описание скаченных произведений. Формат файла JSON, т.е. в данном случае это `список` со множеством `словарей`. Выглядит это так:

  ```
  [
    {
      "title": "Классная Книга",
      "book_author": "Народ",
      "img_src": "images/111.jpg",
      "book_path": "books/Классная_книга.txt",
      "comments": ["Комментарий 1", "Комментарий 2"],
      "genres": ["Жанр 1", "Жанр 2"]
    },
    {
      ...
    },
  ]

  ```
</details>
...

Делать он будет это методично..., но долго, поэтому, чтобы Максим не превратился в своего дедушку, было решено дать ему инструменты, а точнее *аргументы* запуска скрипта.

 ## Аргументы командной строки

 Каждый аргумент запуска скрипта через командную строку, упрощает Максиму жизнь, а дедушке ее удлиняет. Не верите, смотрите:

 - `python main.py --start_page 1 --end_page 2` - качаем книжки только с первой страницы, и отдаем читать дедушке... остальные страницы можем скачать потом, когда дедушка уже все прочитает...

 - `python main.py --end_page 4` - так можно скачать книги только с первых трех страниц (страницы 1-3)

 - `python main.py --start_page 700` - а так все книги с 700-й страницы и до конца всего раздела, скрипт сам поймет какая страница последняя... если только там их не десять тыщь

Усложним?... Соседи дедушки, видя что он пропал, больше не ходит в клуб на танцы, не налегает на горилку, а все свободное время тратит на чтение, тоже могут проявить интерес к ликвидации безграмотности...

Но что, если научная фантастика их не увлечет, ведь в библиотеке есть и `Классические детективы`, и `Современные любовные романы`, `Энциклопедии` в конце концов... имеено для таких целей сделан атрибут `--url`. Т.е. берем url нужного раздела и явно указываем это скрипту, например:

  - `python main.py --url http://tululu.org/l37/` - так качаем всю классику детективного жанра.

  - `python main.py --url http://tululu.org/l96/ --end_page 3` - бабушке можно качнуть пару страничек любовного чтива, но много качать нельзя, а то зачитается... будет засматриваться на дедушку и отвлекать его от чтения...
  - `python main.py --start_page 2 --url http://tululu.org/l113/` - ну и качнем немного энциклопедий... их очень удобно распечатать и читать с бумаги в уличном туалете...

Таким образом, перед Максимом открыты все возможности использования библиотеки, а из жителей деревни, в скором будущем, можно будет сколотить неплохую команду игры `Что? Где? Когда?`.

Если у Максима что то не заладится, есть атрибут `--showlog`, просто добавь после атрибута `yes`, и скрипт будет более подробно сообщать тебе, что делает и что у него не получается. Кстати, про ошибки...

 ## Ошибки, про которые уже известно...

 Скрипт явно укажет Максиму на следующие ошибки:
 - вместо номера первой или последней страницы указана НЕ цифра;
 - номер последней страницы меньше или равен номеру первой страницы
 - нет Интернета, наверно уже приехали в деревню к дедушке...
 - ошибка в указанном url, он ведет на несуществующую страницу, нехватает какого-нить `/` и т.п.
 - скрипт пропустит книгу, если ее нельзя скачать.

Более этого скрипт не предусматривает, вся надежда на Максима.
